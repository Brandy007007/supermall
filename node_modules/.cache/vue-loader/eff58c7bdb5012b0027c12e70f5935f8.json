{"remainingRequest":"/Users/yanjiang/Desktop/cliTest/supermall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yanjiang/Desktop/cliTest/supermall/src/views/detail/Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yanjiang/Desktop/cliTest/supermall/src/views/detail/Detail.vue","mtime":1611582587383},{"path":"/Users/yanjiang/Desktop/cliTest/supermall/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiang/Desktop/cliTest/supermall/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBDaGlsZENvbXBvbmVudHMgZnJvbSAidmlld3MvZGV0YWlsL2NoaWxkY29tcG9uZW50cy9DaGlsZENvbXBvbmVudHMiOwppbXBvcnQgRGV0YWlsU3dpcGVyIGZyb20gInZpZXdzL2RldGFpbC9jaGlsZGNvbXBvbmVudHMvRGV0YWlsU3dpcGVyIjsKaW1wb3J0IERldGFpbEJhc2VJbmZvIGZyb20gInZpZXdzL2RldGFpbC9jaGlsZGNvbXBvbmVudHMvRGV0YWlsQmFzZUluZm8iOwppbXBvcnQgRGV0YWlsU2hvcEluZm8gZnJvbSAidmlld3MvZGV0YWlsL2NoaWxkY29tcG9uZW50cy9EZXRhaWxTaG9wSW5mbyI7CmltcG9ydCBEZXRhaWxHb29kc0luZm8gZnJvbSAidmlld3MvZGV0YWlsL2NoaWxkY29tcG9uZW50cy9EZXRhaWxHb29kc0luZm8iOwppbXBvcnQgRGV0YWlsUGFyYW1JbmZvIGZyb20gInZpZXdzL2RldGFpbC9jaGlsZGNvbXBvbmVudHMvRGV0YWlsUGFyYW1JbmZvIjsKaW1wb3J0IERldGFpbENvbW1lbnRJbmZvIGZyb20gInZpZXdzL2RldGFpbC9jaGlsZGNvbXBvbmVudHMvRGV0YWlsQ29tbWVudEluZm8iOwppbXBvcnQgRGV0YWlsQm90dG9tQmFyIGZyb20gInZpZXdzL2RldGFpbC9jaGlsZGNvbXBvbmVudHMvRGV0YWlsQm90dG9tQmFyIjsKaW1wb3J0IEdvb2RzTGlzdCBmcm9tICJjb21wb25lbnRzL2NvbnRlbnQvZ29vZHMvR29vZHNMaXN0IjsKaW1wb3J0IEJhY2tUb3AgZnJvbSAiY29tcG9uZW50cy9jb250ZW50L2JhY2t0b3AvQmFja1RvcCI7CmltcG9ydCBTY3JvbGwgZnJvbSAiY29tcG9uZW50cy9jb21tb24vc2Nyb2xsL1Njcm9sbCI7CmltcG9ydCBUb2FzdCBmcm9tICJjb21wb25lbnRzL2NvbW1vbi90b2FzdC9Ub2FzdCI7CmltcG9ydCB7IG1hcEFjdGlvbnMgfSBmcm9tICJ2dWV4IjsKCmltcG9ydCB7CiAgZ2V0RGV0YWlsLAogIEdvb2RzLAogIFNob3AsCiAgR29vZHNQYXJhbSwKICBnZXRSZWNvbW1lbmQsCn0gZnJvbSAibmV0d29yay9kZXRhaWwuanMiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkRldGFpbCIsCiAgY29tcG9uZW50czogewogICAgQ2hpbGRDb21wb25lbnRzLAogICAgRGV0YWlsU3dpcGVyLAogICAgRGV0YWlsQmFzZUluZm8sCiAgICBEZXRhaWxTaG9wSW5mbywKICAgIERldGFpbEdvb2RzSW5mbywKICAgIERldGFpbFBhcmFtSW5mbywKICAgIERldGFpbENvbW1lbnRJbmZvLAogICAgRGV0YWlsQm90dG9tQmFyLAogICAgR29vZHNMaXN0LAogICAgQmFja1RvcCwKICAgIFNjcm9sbCwKICAgIFRvYXN0LAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlpZDogbnVsbCwKICAgICAgdG9wSW1hZ2VzOiBbXSwKICAgICAgZ29vZHM6IHt9LAogICAgICBzaG9wOiB7fSwKICAgICAgZGV0YWlsSW5mbzoge30sCiAgICAgIHBhcmFtSW5mbzoge30sCiAgICAgIGNvbW1lbnRJbmZvOiB7fSwKICAgICAgcmVjb21tZW5kczogW10sCiAgICAgIHRoZW1lVG9wWTogW10sCiAgICAgIGN1cnJlbnRJbmRleDogMCwKICAgICAgaXNTaG93QmFja1RvcDogZmFsc2UsCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuaWlkID0gdGhpcy4kcm91dGUucGFyYW1zLmlpZDsKCiAgICBnZXREZXRhaWwodGhpcy5paWQpLnRoZW4oKHJlcykgPT4gewogICAgICAvLyBjb25zb2xlLmxvZyhyZXMpOwogICAgICBjb25zdCBkYXRhID0gcmVzLnJlc3VsdDsKICAgICAgLy8gICByZXMtcmVzdWx0LWl0ZW1pbmZvLXRvcGltYWdlCiAgICAgIHRoaXMudG9wSW1hZ2VzID0gZGF0YS5pdGVtSW5mby50b3BJbWFnZXM7CgogICAgICB0aGlzLmdvb2RzID0gbmV3IEdvb2RzKAogICAgICAgIGRhdGEuaXRlbUluZm8sCiAgICAgICAgZGF0YS5jb2x1bW5zLAogICAgICAgIGRhdGEuc2hvcEluZm8uc2VydmljZXMKICAgICAgKTsKICAgICAgdGhpcy5zaG9wID0gbmV3IFNob3AoZGF0YS5zaG9wSW5mbyk7CgogICAgICB0aGlzLmRldGFpbEluZm8gPSBkYXRhLmRldGFpbEluZm87CgogICAgICB0aGlzLnBhcmFtSW5mbyA9IG5ldyBHb29kc1BhcmFtKAogICAgICAgIGRhdGEuaXRlbVBhcmFtcy5pbmZvLAogICAgICAgIGRhdGEuaXRlbVBhcmFtcy5ydWxlCiAgICAgICk7CiAgICAgIGlmIChkYXRhLnJhdGUubGlzdCAhPT0gMCkgewogICAgICAgIHRoaXMuY29tbWVudEluZm8gPSBkYXRhLnJhdGUubGlzdFswXTsKICAgICAgfQogICAgICBnZXRSZWNvbW1lbmQoKS50aGVuKChyZXMpID0+IHsKICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgIHRoaXMucmVjb21tZW5kcyA9IHJlcy5kYXRhLmxpc3Q7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICBtZXRob2RzOiB7CiAgICAuLi5tYXBBY3Rpb25zKFsiYWRkQ2FydCJdKSwKICAgIGltYWdlTG9hZCgpIHsKICAgICAgdGhpcy4kcmVmcy53cmFwcGVyLnJlZnJlc2goKTsKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMudGhlbWVUb3BZID0gW107CiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy4kcmVmcy5wYXJhbSk7CiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy4kcmVmcy5jb21tZW50KTsKICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLiRyZWZzLmRhdGFpbGdvb2RzKTsKICAgICAgICB0aGlzLnRoZW1lVG9wWS5wdXNoKDApOwogICAgICAgIHRoaXMudGhlbWVUb3BZLnB1c2godGhpcy4kcmVmcy5wYXJhbS4kZWwub2Zmc2V0VG9wIC0gNDQpOwogICAgICAgIHRoaXMudGhlbWVUb3BZLnB1c2godGhpcy4kcmVmcy5jb21tZW50LiRlbC5vZmZzZXRUb3AgLSA0NCk7CiAgICAgICAgdGhpcy50aGVtZVRvcFkucHVzaCh0aGlzLiRyZWZzLmRhdGFpbGdvb2RzLiRlbC5vZmZzZXRUb3AgLSA0NCk7CiAgICAgICAgdGhpcy50aGVtZVRvcFkucHVzaChOdW1iZXIuTUFYX1ZBTFVFKTsKICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLnRoZW1lVG9wWSk7CiAgICAgIH0pOwogICAgfSwKICAgIGRldGFpbFRvcENsaWNrKGluZGV4KSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKGluZGV4KTsKICAgICAgdGhpcy4kcmVmcy53cmFwcGVyLnNjcm9sbFRvKDAsIC10aGlzLnRoZW1lVG9wWVtpbmRleF0sIDIwMCk7CiAgICB9LAogICAgY29udGVudFNjcm9sbChwb3NpdGlvbikgewogICAgICAvLyBjb25zb2xlLmxvZyhwb3NpdGlvbik7CiAgICAgIHRoaXMuaXNTaG93QmFja1RvcCA9IC1wb3NpdGlvbi55ID4gNTAwOwogICAgICBjb25zdCBwb3NpdGlvblkgPSAtcG9zaXRpb24ueTsKICAgICAgY29uc3QgbGVuZ3RoID0gdGhpcy50aGVtZVRvcFkubGVuZ3RoOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aCAtIDE7IGkrKykgewogICAgICAgIGlmICgKICAgICAgICAgIHRoaXMuY3VycmVudEluZGV4ICE9PSBpICYmCiAgICAgICAgICBwb3NpdGlvblkgPj0gdGhpcy50aGVtZVRvcFlbaV0gJiYKICAgICAgICAgIHBvc2l0aW9uWSA8IHRoaXMudGhlbWVUb3BZW2kgKyAxXQogICAgICAgICkgewogICAgICAgICAgLy8gdGhpcy5jdXJyZW50SW5kZXggPSBpOwogICAgICAgICAgdGhpcy4kcmVmcy5kZXRhaWxUb3BCYXIuY3VycmVudEluZGV4ID0gaTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBiYWNrQ2xpY2soKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKCLnrq3lpLTngrnlh7vkuoYiKTsKICAgICAgLy8gY29uc29sZS5sb2codGhpcy4kcmVmcy5zY3JvbGwuc2Nyb2xsKTsKICAgICAgdGhpcy4kcmVmcy53cmFwcGVyLnNjcm9sbFRvKDAsIDAsIDUwMCk7CiAgICB9LAogICAgYWRkYWRkQ2FydCgpIHsKICAgICAgLy8gY29uc29sZS5sb2coIua3u+WKoOi0reeJqei9piIpOwogICAgICBjb25zdCBwcm9kdWN0ID0ge307CiAgICAgIHByb2R1Y3QuaW1hZ2UgPSB0aGlzLnRvcEltYWdlc1swXTsKICAgICAgcHJvZHVjdC50aXRsZSA9IHRoaXMuZ29vZHMudGl0bGU7CiAgICAgIHByb2R1Y3QuZGVzYyA9IHRoaXMuZ29vZHMuZGVzYzsKICAgICAgcHJvZHVjdC5wcmljZSA9IHRoaXMuZ29vZHMucmVhbFByaWNlOwogICAgICBwcm9kdWN0LmlpZCA9IHRoaXMuaWlkOwogICAgICAvLyB0aGlzLiRzdG9yZS5jb21taXQoJ2FkZENhcnQnLCBwcm9kdWN0KTsKICAgICAgLy8gY29uc29sZS5sb2coIn5+fn5+Iik7CiAgICAgIHRoaXMuYWRkQ2FydChwcm9kdWN0KS50aGVuKChyZXMpID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhwcm9kdWN0KTsKICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuJHRvYXN0KTsKICAgICAgICB0aGlzLiR0b2FzdC5zaG93KHJlcywgMjAwMCk7CiAgICAgIH0pOwogICAgIAogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["Detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"Detail.vue","sourceRoot":"src/views/detail","sourcesContent":["<template>\n  <div class=\"detail\">\n    <child-components\n      class=\"detailtopbar\"\n      @detailTopClick=\"detailTopClick\"\n      ref=\"detailTopBar\"\n    ></child-components>\n\n    <scroll\n      class=\"content\"\n      ref=\"wrapper\"\n      :pullUpLoad=\"true\"\n      @scroll=\"contentScroll\"\n    >\n      <detail-swiper :top-images=\"topImages\"></detail-swiper>\n      <detail-base-info :goods=\"goods\"></detail-base-info>\n      <detail-shop-info :shop=\"shop\"></detail-shop-info>\n      <detail-goods-info\n        :detail-info=\"detailInfo\"\n        @imageLoad=\"imageLoad\"\n      ></detail-goods-info>\n      <detail-param-info\n        :param-info=\"paramInfo\"\n        ref=\"param\"\n      ></detail-param-info>\n      <detail-comment-info\n        :comment-info=\"commentInfo\"\n        ref=\"comment\"\n      ></detail-comment-info>\n      <goods-list :goods=\"recommends\" ref=\"datailgoods\"></goods-list>\n    </scroll>\n    <detail-bottom-bar\n      class=\"detail-bottom\"\n      @addCart=\"addaddCart\"\n    ></detail-bottom-bar>\n    <back-top @click.native=\"backClick\" v-show=\"isShowBackTop\"></back-top>\n  </div>\n</template>\n\n<script>\nimport ChildComponents from \"views/detail/childcomponents/ChildComponents\";\nimport DetailSwiper from \"views/detail/childcomponents/DetailSwiper\";\nimport DetailBaseInfo from \"views/detail/childcomponents/DetailBaseInfo\";\nimport DetailShopInfo from \"views/detail/childcomponents/DetailShopInfo\";\nimport DetailGoodsInfo from \"views/detail/childcomponents/DetailGoodsInfo\";\nimport DetailParamInfo from \"views/detail/childcomponents/DetailParamInfo\";\nimport DetailCommentInfo from \"views/detail/childcomponents/DetailCommentInfo\";\nimport DetailBottomBar from \"views/detail/childcomponents/DetailBottomBar\";\nimport GoodsList from \"components/content/goods/GoodsList\";\nimport BackTop from \"components/content/backtop/BackTop\";\nimport Scroll from \"components/common/scroll/Scroll\";\nimport Toast from \"components/common/toast/Toast\";\nimport { mapActions } from \"vuex\";\n\nimport {\n  getDetail,\n  Goods,\n  Shop,\n  GoodsParam,\n  getRecommend,\n} from \"network/detail.js\";\nexport default {\n  name: \"Detail\",\n  components: {\n    ChildComponents,\n    DetailSwiper,\n    DetailBaseInfo,\n    DetailShopInfo,\n    DetailGoodsInfo,\n    DetailParamInfo,\n    DetailCommentInfo,\n    DetailBottomBar,\n    GoodsList,\n    BackTop,\n    Scroll,\n    Toast,\n  },\n  data() {\n    return {\n      iid: null,\n      topImages: [],\n      goods: {},\n      shop: {},\n      detailInfo: {},\n      paramInfo: {},\n      commentInfo: {},\n      recommends: [],\n      themeTopY: [],\n      currentIndex: 0,\n      isShowBackTop: false,\n    };\n  },\n  created() {\n    this.iid = this.$route.params.iid;\n\n    getDetail(this.iid).then((res) => {\n      // console.log(res);\n      const data = res.result;\n      //   res-result-iteminfo-topimage\n      this.topImages = data.itemInfo.topImages;\n\n      this.goods = new Goods(\n        data.itemInfo,\n        data.columns,\n        data.shopInfo.services\n      );\n      this.shop = new Shop(data.shopInfo);\n\n      this.detailInfo = data.detailInfo;\n\n      this.paramInfo = new GoodsParam(\n        data.itemParams.info,\n        data.itemParams.rule\n      );\n      if (data.rate.list !== 0) {\n        this.commentInfo = data.rate.list[0];\n      }\n      getRecommend().then((res) => {\n        // console.log(res);\n        this.recommends = res.data.list;\n      });\n    });\n  },\n  methods: {\n    ...mapActions([\"addCart\"]),\n    imageLoad() {\n      this.$refs.wrapper.refresh();\n      this.$nextTick(() => {\n        this.themeTopY = [];\n        // console.log(this.$refs.param);\n        // console.log(this.$refs.comment);\n        // console.log(this.$refs.datailgoods);\n        this.themeTopY.push(0);\n        this.themeTopY.push(this.$refs.param.$el.offsetTop - 44);\n        this.themeTopY.push(this.$refs.comment.$el.offsetTop - 44);\n        this.themeTopY.push(this.$refs.datailgoods.$el.offsetTop - 44);\n        this.themeTopY.push(Number.MAX_VALUE);\n        // console.log(this.themeTopY);\n      });\n    },\n    detailTopClick(index) {\n      // console.log(index);\n      this.$refs.wrapper.scrollTo(0, -this.themeTopY[index], 200);\n    },\n    contentScroll(position) {\n      // console.log(position);\n      this.isShowBackTop = -position.y > 500;\n      const positionY = -position.y;\n      const length = this.themeTopY.length;\n      for (let i = 0; i < length - 1; i++) {\n        if (\n          this.currentIndex !== i &&\n          positionY >= this.themeTopY[i] &&\n          positionY < this.themeTopY[i + 1]\n        ) {\n          // this.currentIndex = i;\n          this.$refs.detailTopBar.currentIndex = i;\n        }\n      }\n    },\n    backClick() {\n      // console.log(\"箭头点击了\");\n      // console.log(this.$refs.scroll.scroll);\n      this.$refs.wrapper.scrollTo(0, 0, 500);\n    },\n    addaddCart() {\n      // console.log(\"添加购物车\");\n      const product = {};\n      product.image = this.topImages[0];\n      product.title = this.goods.title;\n      product.desc = this.goods.desc;\n      product.price = this.goods.realPrice;\n      product.iid = this.iid;\n      // this.$store.commit('addCart', product);\n      // console.log(\"~~~~~\");\n      this.addCart(product).then((res) => {\n        console.log(product);\n        console.log(res);\n        // console.log(this.$toast);\n        this.$toast.show(res, 2000);\n      });\n     \n    },\n  },\n};\n</script>\n\n<style scoped>\n.detail {\n  position: relative;\n  z-index: 10;\n  background-color: white;\n  height: 100vh;\n}\n.detailtopbar {\n  position: relative;\n  z-index: 11;\n  background-color: white;\n}\n.content {\n  height: calc(100% - 44px - 49px);\n  position: relative;\n  /* background-color: #fff; */\n  overflow: hidden;\n}\n.detail-bottom {\n  background-color: #fff;\n}\n</style>"]}]}