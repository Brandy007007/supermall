{"remainingRequest":"/Users/yanjiang/Desktop/cliTest/supermall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yanjiang/Desktop/cliTest/supermall/src/views/detail/Detail.vue?vue&type=style&index=0&id=117d0e76&scoped=true&lang=css&","dependencies":[{"path":"/Users/yanjiang/Desktop/cliTest/supermall/src/views/detail/Detail.vue","mtime":1611582588278},{"path":"/Users/yanjiang/Desktop/cliTest/supermall/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiang/Desktop/cliTest/supermall/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/yanjiang/Desktop/cliTest/supermall/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/yanjiang/Desktop/cliTest/supermall/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanjiang/Desktop/cliTest/supermall/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5kZXRhaWwgewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICB6LWluZGV4OiAxMDsKICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTsKICBoZWlnaHQ6IDEwMHZoOwp9Ci5kZXRhaWx0b3BiYXIgewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKICB6LWluZGV4OiAxMTsKICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTsKfQouY29udGVudCB7CiAgaGVpZ2h0OiBjYWxjKDEwMCUgLSA0NHB4IC0gNDlweCk7CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIC8qIGJhY2tncm91bmQtY29sb3I6ICNmZmY7ICovCiAgb3ZlcmZsb3c6IGhpZGRlbjsKfQouZGV0YWlsLWJvdHRvbSB7CiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsKfQo="},{"version":3,"sources":["Detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Detail.vue","sourceRoot":"src/views/detail","sourcesContent":["<template>\n  <div class=\"detail\">\n    <child-components\n      class=\"detailtopbar\"\n      @detailTopClick=\"detailTopClick\"\n      ref=\"detailTopBar\"\n    ></child-components>\n\n    <scroll\n      class=\"content\"\n      ref=\"wrapper\"\n      :pullUpLoad=\"true\"\n      @scroll=\"contentScroll\"\n    >\n      <detail-swiper :top-images=\"topImages\"></detail-swiper>\n      <detail-base-info :goods=\"goods\"></detail-base-info>\n      <detail-shop-info :shop=\"shop\"></detail-shop-info>\n      <detail-goods-info\n        :detail-info=\"detailInfo\"\n        @imageLoad=\"imageLoad\"\n      ></detail-goods-info>\n      <detail-param-info\n        :param-info=\"paramInfo\"\n        ref=\"param\"\n      ></detail-param-info>\n      <detail-comment-info\n        :comment-info=\"commentInfo\"\n        ref=\"comment\"\n      ></detail-comment-info>\n      <goods-list :goods=\"recommends\" ref=\"datailgoods\"></goods-list>\n    </scroll>\n    <detail-bottom-bar\n      class=\"detail-bottom\"\n      @addCart=\"addaddCart\"\n    ></detail-bottom-bar>\n    <back-top @click.native=\"backClick\" v-show=\"isShowBackTop\"></back-top>\n  </div>\n</template>\n\n<script>\nimport ChildComponents from \"views/detail/childcomponents/ChildComponents\";\nimport DetailSwiper from \"views/detail/childcomponents/DetailSwiper\";\nimport DetailBaseInfo from \"views/detail/childcomponents/DetailBaseInfo\";\nimport DetailShopInfo from \"views/detail/childcomponents/DetailShopInfo\";\nimport DetailGoodsInfo from \"views/detail/childcomponents/DetailGoodsInfo\";\nimport DetailParamInfo from \"views/detail/childcomponents/DetailParamInfo\";\nimport DetailCommentInfo from \"views/detail/childcomponents/DetailCommentInfo\";\nimport DetailBottomBar from \"views/detail/childcomponents/DetailBottomBar\";\nimport GoodsList from \"components/content/goods/GoodsList\";\nimport BackTop from \"components/content/backtop/BackTop\";\nimport Scroll from \"components/common/scroll/Scroll\";\nimport Toast from \"components/common/toast/Toast\";\nimport { mapActions } from \"vuex\";\n\nimport {\n  getDetail,\n  Goods,\n  Shop,\n  GoodsParam,\n  getRecommend,\n} from \"network/detail.js\";\nexport default {\n  name: \"Detail\",\n  components: {\n    ChildComponents,\n    DetailSwiper,\n    DetailBaseInfo,\n    DetailShopInfo,\n    DetailGoodsInfo,\n    DetailParamInfo,\n    DetailCommentInfo,\n    DetailBottomBar,\n    GoodsList,\n    BackTop,\n    Scroll,\n    Toast,\n  },\n  data() {\n    return {\n      iid: null,\n      topImages: [],\n      goods: {},\n      shop: {},\n      detailInfo: {},\n      paramInfo: {},\n      commentInfo: {},\n      recommends: [],\n      themeTopY: [],\n      currentIndex: 0,\n      isShowBackTop: false,\n    };\n  },\n  created() {\n    this.iid = this.$route.params.iid;\n\n    getDetail(this.iid).then((res) => {\n      // console.log(res);\n      const data = res.result;\n      //   res-result-iteminfo-topimage\n      this.topImages = data.itemInfo.topImages;\n\n      this.goods = new Goods(\n        data.itemInfo,\n        data.columns,\n        data.shopInfo.services\n      );\n      this.shop = new Shop(data.shopInfo);\n\n      this.detailInfo = data.detailInfo;\n\n      this.paramInfo = new GoodsParam(\n        data.itemParams.info,\n        data.itemParams.rule\n      );\n      if (data.rate.list !== 0) {\n        this.commentInfo = data.rate.list[0];\n      }\n      getRecommend().then((res) => {\n        // console.log(res);\n        this.recommends = res.data.list;\n      });\n    });\n  },\n  methods: {\n    ...mapActions([\"addCart\"]),\n    imageLoad() {\n      this.$refs.wrapper.refresh();\n      this.$nextTick(() => {\n        this.themeTopY = [];\n        // console.log(this.$refs.param);\n        // console.log(this.$refs.comment);\n        // console.log(this.$refs.datailgoods);\n        this.themeTopY.push(0);\n        this.themeTopY.push(this.$refs.param.$el.offsetTop - 44);\n        this.themeTopY.push(this.$refs.comment.$el.offsetTop - 44);\n        this.themeTopY.push(this.$refs.datailgoods.$el.offsetTop - 44);\n        this.themeTopY.push(Number.MAX_VALUE);\n        // console.log(this.themeTopY);\n      });\n    },\n    detailTopClick(index) {\n      // console.log(index);\n      this.$refs.wrapper.scrollTo(0, -this.themeTopY[index], 200);\n    },\n    contentScroll(position) {\n      // console.log(position);\n      this.isShowBackTop = -position.y > 500;\n      const positionY = -position.y;\n      const length = this.themeTopY.length;\n      for (let i = 0; i < length - 1; i++) {\n        if (\n          this.currentIndex !== i &&\n          positionY >= this.themeTopY[i] &&\n          positionY < this.themeTopY[i + 1]\n        ) {\n          // this.currentIndex = i;\n          this.$refs.detailTopBar.currentIndex = i;\n        }\n      }\n    },\n    backClick() {\n      // console.log(\"箭头点击了\");\n      // console.log(this.$refs.scroll.scroll);\n      this.$refs.wrapper.scrollTo(0, 0, 500);\n    },\n    addaddCart() {\n      // console.log(\"添加购物车\");\n      const product = {};\n      product.image = this.topImages[0];\n      product.title = this.goods.title;\n      product.desc = this.goods.desc;\n      product.price = this.goods.realPrice;\n      product.iid = this.iid;\n      // this.$store.commit('addCart', product);\n      // console.log(\"~~~~~\");\n      this.addCart(product).then((res) => {\n        console.log(product);\n        console.log(res);\n        // console.log(this.$toast);\n        this.$toast.show(res, 2000);\n      });\n    },\n  },\n};\n</script>\n\n<style scoped>\n.detail {\n  position: relative;\n  z-index: 10;\n  background-color: white;\n  height: 100vh;\n}\n.detailtopbar {\n  position: relative;\n  z-index: 11;\n  background-color: white;\n}\n.content {\n  height: calc(100% - 44px - 49px);\n  position: relative;\n  /* background-color: #fff; */\n  overflow: hidden;\n}\n.detail-bottom {\n  background-color: #fff;\n}\n</style>"]}]}